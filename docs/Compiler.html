<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<title>Compiler</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library Compiler</h1>

<div class="code">
<span class="id" title="keyword">Set</span> <span class="id" title="var">Warnings</span> "-notation-overridden,-parsing".<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Strings.String</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Bool.Bool</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Arith.Arith</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Lists.List</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">StorelessMachine</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Sequences</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">StorelessMachine</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Maps</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">StorelessMachine</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Imp</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">StorelessMachine</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Facts</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Omega</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">normalize</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">app_length</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_assoc</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_0_r</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Nat.sub_0_r</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">normalize2</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">app_length</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_assoc</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_0_r</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Nat.sub_0_r</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Nat.add_1_r</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Nat.add_0_r</span> <span class="id" title="tactic">in</span> *;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">compile_aexp</span> (<span class="id" title="var">stklen</span>: <span class="id" title="var">nat</span>) (<span class="id" title="var">vlist</span> : <span class="id" title="var">varlist</span>) (<span class="id" title="var">a</span>:<span class="id" title="var">aexp</span>): <span class="id" title="var">code</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">a</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">ANum</span> <span class="id" title="var">n</span> =&gt; <span class="id" title="var">Iconst</span> <span class="id" title="var">n</span> :: <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">AId</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="keyword">match</span> <span class="id" title="var">find</span> <span class="id" title="var">x</span> <span class="id" title="var">vlist</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">None</span> =&gt; <span class="id" title="var">Iconst</span> 0 :: <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Some</span> <span class="id" title="var">n</span> =&gt; <span class="id" title="var">Iget</span> (<span class="id" title="var">stklen</span>-(<span class="id" title="var">length</span> <span class="id" title="var">vlist</span>)+<span class="id" title="var">n</span>) :: <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">APlus</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> =&gt; <span class="id" title="keyword">let</span> <span class="id" title="var">code1</span> := <span class="id" title="var">compile_aexp</span> <span class="id" title="var">stklen</span> <span class="id" title="var">vlist</span> <span class="id" title="var">a1</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">code2</span> := <span class="id" title="var">compile_aexp</span> (<span class="id" title="var">stklen</span>+1) <span class="id" title="var">vlist</span> <span class="id" title="var">a2</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">code1</span> ++ <span class="id" title="var">code2</span> ++ <span class="id" title="var">Iadd</span>::<span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">AMul</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> =&gt; <span class="id" title="keyword">let</span> <span class="id" title="var">code1</span> := <span class="id" title="var">compile_aexp</span> <span class="id" title="var">stklen</span> <span class="id" title="var">vlist</span> <span class="id" title="var">a1</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">code2</span> := <span class="id" title="var">compile_aexp</span> (<span class="id" title="var">stklen</span>+1) <span class="id" title="var">vlist</span> <span class="id" title="var">a2</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">code1</span> ++ <span class="id" title="var">code2</span> ++ <span class="id" title="var">Imul</span>::<span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">AMinus</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> =&gt; <span class="id" title="keyword">let</span> <span class="id" title="var">code1</span> := <span class="id" title="var">compile_aexp</span> <span class="id" title="var">stklen</span> <span class="id" title="var">vlist</span> <span class="id" title="var">a1</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">code2</span> := <span class="id" title="var">compile_aexp</span> (<span class="id" title="var">stklen</span>+1) <span class="id" title="var">vlist</span> <span class="id" title="var">a2</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">code1</span> ++ <span class="id" title="var">code2</span> ++ <span class="id" title="var">Isub</span>::<span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">compile_bexp</span> (<span class="id" title="var">stklen</span>: <span class="id" title="var">nat</span>) (<span class="id" title="var">vlist</span> : <span class="id" title="var">varlist</span>) (<span class="id" title="var">b</span>:<span class="id" title="var">bexp</span>) (<span class="id" title="var">cond</span>:<span class="id" title="var">bool</span>) (<span class="id" title="var">ofs</span>:<span class="id" title="var">nat</span>): <span class="id" title="var">code</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">b</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">BTrue</span> =&gt; <span class="id" title="keyword">if</span> <span class="id" title="var">cond</span> <span class="id" title="keyword">then</span> <span class="id" title="var">Ibranch_forward</span> <span class="id" title="var">ofs</span> :: <span class="id" title="var">nil</span> <span class="id" title="keyword">else</span> <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">BFalse</span> =&gt; <span class="id" title="keyword">if</span> <span class="id" title="var">cond</span> <span class="id" title="keyword">then</span> <span class="id" title="var">nil</span> <span class="id" title="keyword">else</span> <span class="id" title="var">Ibranch_forward</span> <span class="id" title="var">ofs</span> :: <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">BEq</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">code1</span> := <span class="id" title="var">compile_aexp</span> <span class="id" title="var">stklen</span> <span class="id" title="var">vlist</span> <span class="id" title="var">a1</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">code2</span> := <span class="id" title="var">compile_aexp</span> (<span class="id" title="var">stklen</span>+1) <span class="id" title="var">vlist</span> <span class="id" title="var">a2</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">code1</span> ++ <span class="id" title="var">code2</span> ++<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">if</span> <span class="id" title="var">cond</span> <span class="id" title="keyword">then</span> <span class="id" title="var">Ibeq</span> <span class="id" title="var">ofs</span> :: <span class="id" title="var">nil</span> <span class="id" title="keyword">else</span> <span class="id" title="var">Ibne</span> <span class="id" title="var">ofs</span> :: <span class="id" title="var">nil</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">BLe</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">ans1</span> := <span class="id" title="var">compile_aexp</span> <span class="id" title="var">stklen</span> <span class="id" title="var">vlist</span> <span class="id" title="var">a1</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">ans2</span> := <span class="id" title="var">compile_aexp</span> (<span class="id" title="var">stklen</span>+1) <span class="id" title="var">vlist</span> <span class="id" title="var">a2</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ans1</span> ++ <span class="id" title="var">ans2</span> ++<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">if</span> <span class="id" title="var">cond</span> <span class="id" title="keyword">then</span> <span class="id" title="var">Ible</span> <span class="id" title="var">ofs</span> :: <span class="id" title="var">nil</span> <span class="id" title="keyword">else</span> <span class="id" title="var">Ibgt</span> <span class="id" title="var">ofs</span> :: <span class="id" title="var">nil</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">BNot</span> <span class="id" title="var">b1</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">compile_bexp</span> <span class="id" title="var">stklen</span> <span class="id" title="var">vlist</span> <span class="id" title="var">b1</span> (<span class="id" title="var">negb</span> <span class="id" title="var">cond</span>) <span class="id" title="var">ofs</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">BAnd</span> <span class="id" title="var">b1</span> <span class="id" title="var">b2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">code2</span> := <span class="id" title="var">compile_bexp</span> <span class="id" title="var">stklen</span> <span class="id" title="var">vlist</span> <span class="id" title="var">b2</span> <span class="id" title="var">cond</span> <span class="id" title="var">ofs</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">code1</span> := <span class="id" title="var">compile_bexp</span> <span class="id" title="var">stklen</span> <span class="id" title="var">vlist</span> <span class="id" title="var">b1</span> <span class="id" title="var">false</span> (<span class="id" title="keyword">if</span> <span class="id" title="var">cond</span> <span class="id" title="keyword">then</span> <span class="id" title="var">length</span> <span class="id" title="var">code2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">ofs</span> + (<span class="id" title="var">length</span> <span class="id" title="var">code2</span>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">code1</span> ++ <span class="id" title="var">code2</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">compile_com</span> (<span class="id" title="var">stklen</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">vlist</span>: <span class="id" title="var">varlist</span>) (<span class="id" title="var">c</span>:<span class="id" title="var">com</span>): <span class="id" title="var">code</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">c</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">SKIP</span> =&gt; <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">c1</span> ;; <span class="id" title="var">c2</span> =&gt; (<span class="id" title="var">compile_com</span> <span class="id" title="var">stklen</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">vlist</span> <span class="id" title="var">c1</span>) ++ (<span class="id" title="var">compile_com</span> <span class="id" title="var">stklen</span> <span class="id" title="var">vlist</span> <span class="id" title="var">c2</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">IFB</span> <span class="id" title="var">b</span> <span class="id" title="var">THEN</span> <span class="id" title="var">ifso</span> <span class="id" title="var">ELSE</span> <span class="id" title="var">ifnot</span> <span class="id" title="var">FI</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">code_ifso</span> := <span class="id" title="var">compile_com</span> <span class="id" title="var">stklen</span> <span class="id" title="var">vlist</span> <span class="id" title="var">ifso</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">code_ifnot</span> := <span class="id" title="var">compile_com</span> <span class="id" title="var">stklen</span> <span class="id" title="var">vlist</span> <span class="id" title="var">ifnot</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">compile_bexp</span> <span class="id" title="var">stklen</span> <span class="id" title="var">vlist</span> <span class="id" title="var">b</span> <span class="id" title="var">false</span> (<span class="id" title="var">length</span> <span class="id" title="var">code_ifso</span> + 1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="var">code_ifso</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="var">Ibranch_forward</span> (<span class="id" title="var">length</span> <span class="id" title="var">code_ifnot</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: <span class="id" title="var">code_ifnot</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">WHILE</span> <span class="id" title="var">b</span> <span class="id" title="var">DO</span> <span class="id" title="var">body</span> <span class="id" title="var">END</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">code_body</span> := <span class="id" title="var">compile_com</span> <span class="id" title="var">stklen</span> <span class="id" title="var">vlist</span> <span class="id" title="var">body</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">code_test</span> := <span class="id" title="var">compile_bexp</span> <span class="id" title="var">stklen</span> <span class="id" title="var">vlist</span> <span class="id" title="var">b</span> <span class="id" title="var">false</span> (<span class="id" title="var">length</span> <span class="id" title="var">code_body</span> + 1) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">code_test</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="var">code_body</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="var">Ibranch_backward</span> (<span class="id" title="var">length</span> <span class="id" title="var">code_test</span> + <span class="id" title="var">length</span> <span class="id" title="var">code_body</span> + 1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;:: <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">var</span> ::= <span class="id" title="var">a</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">find</span> (<span class="id" title="var">Id</span> <span class="id" title="var">var</span>) <span class="id" title="var">vlist</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Some</span> <span class="id" title="var">n</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">compile_aexp</span> <span class="id" title="var">stklen</span> <span class="id" title="var">vlist</span> <span class="id" title="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++ <span class="id" title="var">Iset</span> (<span class="id" title="var">stklen</span> - <span class="id" title="var">length</span> <span class="id" title="var">vlist</span> + <span class="id" title="var">n</span>) ::<span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">initialize_vars</span> (<span class="id" title="var">l</span> : <span class="id" title="var">varlist</span>): <span class="id" title="var">code</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">nil</span> =&gt; <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">v</span> :: <span class="id" title="var">l'</span> =&gt; (<span class="id" title="var">Iconst</span> <span class="id" title="var">O</span>) :: <span class="id" title="var">initialize_vars</span> <span class="id" title="var">l'</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">zerostk_of_len</span> (<span class="id" title="var">n</span>: <span class="id" title="var">nat</span>) : <span class="id" title="var">stack</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span> | <span class="id" title="var">O</span> =&gt; <span class="id" title="var">nil</span> | <span class="id" title="var">S</span> <span class="id" title="var">n'</span> =&gt; <span class="id" title="var">O</span> :: <span class="id" title="var">zerostk_of_len</span> <span class="id" title="var">n'</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">compile_program</span> (<span class="id" title="var">p</span>: <span class="id" title="var">com</span>): <span class="id" title="var">code</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">vlist</span> := <span class="id" title="var">gen_vlist</span> <span class="id" title="var">p</span> <span class="id" title="var">nil</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">initialize_vars</span> <span class="id" title="var">vlist</span><br/>
&nbsp;&nbsp;++ <span class="id" title="var">compile_com</span> (<span class="id" title="var">length</span> <span class="id" title="var">vlist</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;++ <span class="id" title="var">Ihalt</span>::<span class="id" title="var">nil</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">aeval</span> (<span class="id" title="var">st</span> : <span class="id" title="var">state</span>) (<span class="id" title="var">a</span>:<span class="id" title="var">aexp</span>): <span class="id" title="var">nat</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">a</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">ANum</span> <span class="id" title="var">n</span> =&gt; <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">AId</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">st</span> <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">APlus</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> =&gt; (<span class="id" title="var">aeval</span> <span class="id" title="var">st</span> <span class="id" title="var">a1</span>) + (<span class="id" title="var">aeval</span> <span class="id" title="var">st</span> <span class="id" title="var">a2</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">AMinus</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> =&gt; (<span class="id" title="var">aeval</span> <span class="id" title="var">st</span> <span class="id" title="var">a1</span>) - (<span class="id" title="var">aeval</span> <span class="id" title="var">st</span> <span class="id" title="var">a2</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">AMul</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> =&gt; (<span class="id" title="var">aeval</span> <span class="id" title="var">st</span> <span class="id" title="var">a1</span>) * (<span class="id" title="var">aeval</span> <span class="id" title="var">st</span> <span class="id" title="var">a2</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">beval</span> (<span class="id" title="var">st</span> : <span class="id" title="var">state</span>) (<span class="id" title="var">b</span> : <span class="id" title="var">bexp</span>) : <span class="id" title="var">bool</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">b</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">BTrue</span>       =&gt; <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">BFalse</span>      =&gt; <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">BEq</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span>   =&gt; <span class="id" title="var">beq_nat</span> (<span class="id" title="var">aeval</span> <span class="id" title="var">st</span> <span class="id" title="var">a1</span>) (<span class="id" title="var">aeval</span> <span class="id" title="var">st</span> <span class="id" title="var">a2</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">BLe</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span>   =&gt; <span class="id" title="var">leb</span> (<span class="id" title="var">aeval</span> <span class="id" title="var">st</span> <span class="id" title="var">a1</span>) (<span class="id" title="var">aeval</span> <span class="id" title="var">st</span> <span class="id" title="var">a2</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">BNot</span> <span class="id" title="var">b1</span>     =&gt; <span class="id" title="var">negb</span> (<span class="id" title="var">beval</span> <span class="id" title="var">st</span> <span class="id" title="var">b1</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">BAnd</span> <span class="id" title="var">b1</span> <span class="id" title="var">b2</span>  =&gt; <span class="id" title="var">andb</span> (<span class="id" title="var">beval</span> <span class="id" title="var">st</span> <span class="id" title="var">b1</span>) (<span class="id" title="var">beval</span> <span class="id" title="var">st</span> <span class="id" title="var">b2</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">aeval_stk</span> (<span class="id" title="var">v</span>:<span class="id" title="var">varlist</span>) (<span class="id" title="var">stk</span>: <span class="id" title="var">stack</span>) (<span class="id" title="var">a</span>:<span class="id" title="var">aexp</span>): <span class="id" title="var">nat</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">a</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">ANum</span> <span class="id" title="var">n</span> =&gt; <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">AId</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="keyword">match</span> <span class="id" title="var">find</span> <span class="id" title="var">x</span> <span class="id" title="var">v</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Some</span> <span class="id" title="var">n</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">get_nth_slot</span> <span class="id" title="var">stk</span> ((<span class="id" title="var">length</span> <span class="id" title="var">stk</span>) - (<span class="id" title="var">length</span> <span class="id" title="var">v</span>) + <span class="id" title="var">n</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Some</span> <span class="id" title="var">val</span> =&gt; <span class="id" title="var">val</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">APlus</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> =&gt; (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> <span class="id" title="var">stk</span> <span class="id" title="var">a1</span>) + (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> ((<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> <span class="id" title="var">stk</span> <span class="id" title="var">a1</span>) ::<span class="id" title="var">stk</span>) <span class="id" title="var">a2</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">AMinus</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> =&gt; (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> <span class="id" title="var">stk</span> <span class="id" title="var">a1</span>) - (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> ((<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> <span class="id" title="var">stk</span> <span class="id" title="var">a1</span>) ::<span class="id" title="var">stk</span>) <span class="id" title="var">a2</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">AMul</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> =&gt; (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> <span class="id" title="var">stk</span> <span class="id" title="var">a1</span>) * (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> ((<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> <span class="id" title="var">stk</span> <span class="id" title="var">a1</span>) ::<span class="id" title="var">stk</span>) <span class="id" title="var">a2</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">beval_stk</span> (<span class="id" title="var">v</span>:<span class="id" title="var">varlist</span>) (<span class="id" title="var">stk</span>: <span class="id" title="var">stack</span>) (<span class="id" title="var">b</span>:<span class="id" title="var">bexp</span>): <span class="id" title="var">bool</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">b</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">BTrue</span> =&gt; <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">BFalse</span> =&gt; <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">BEq</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> =&gt; <span class="id" title="var">beq_nat</span> (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> <span class="id" title="var">stk</span> <span class="id" title="var">a1</span>) (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> <span class="id" title="var">stk</span> <span class="id" title="var">a2</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">BLe</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> =&gt; <span class="id" title="var">leb</span> (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> <span class="id" title="var">stk</span> <span class="id" title="var">a1</span>) (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> <span class="id" title="var">stk</span> <span class="id" title="var">a2</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">BNot</span> <span class="id" title="var">b1</span> =&gt; <span class="id" title="var">negb</span> (<span class="id" title="var">beval_stk</span> <span class="id" title="var">v</span> <span class="id" title="var">stk</span> <span class="id" title="var">b1</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">BAnd</span> <span class="id" title="var">b1</span> <span class="id" title="var">b2</span> =&gt; <span class="id" title="var">andb</span> (<span class="id" title="var">beval_stk</span> <span class="id" title="var">v</span> <span class="id" title="var">stk</span> <span class="id" title="var">b1</span>) (<span class="id" title="var">beval_stk</span> <span class="id" title="var">v</span> <span class="id" title="var">stk</span> <span class="id" title="var">b2</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">varlist_contains_all</span> : <span class="id" title="var">com</span> -&gt; <span class="id" title="var">varlist</span> -&gt; <span class="id" title="keyword">Prop</span> :=<br/>
| <span class="id" title="var">Vseq</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span> <span class="id" title="var">vlist</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">varlist_contains_all</span> <span class="id" title="var">c1</span> <span class="id" title="var">vlist</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">varlist_contains_all</span> <span class="id" title="var">c2</span> <span class="id" title="var">vlist</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">varlist_contains_all</span> (<span class="id" title="var">c1</span> ;; <span class="id" title="var">c2</span>) <span class="id" title="var">vlist</span><br/>
| <span class="id" title="var">Vifb</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span> <span class="id" title="var">vlist</span> <span class="id" title="var">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">varlist_contains_all</span> <span class="id" title="var">c1</span> <span class="id" title="var">vlist</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">varlist_contains_all</span> <span class="id" title="var">c2</span> <span class="id" title="var">vlist</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">varlist_contains_all</span> (<span class="id" title="var">IFB</span> <span class="id" title="var">b</span> <span class="id" title="var">THEN</span> <span class="id" title="var">c1</span> <span class="id" title="var">ELSE</span> <span class="id" title="var">c2</span> <span class="id" title="var">FI</span>) <span class="id" title="var">vlist</span><br/>
| <span class="id" title="var">Vwhile</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">c</span> <span class="id" title="var">vlist</span> <span class="id" title="var">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">varlist_contains_all</span> <span class="id" title="var">c</span> <span class="id" title="var">vlist</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">varlist_contains_all</span> (<span class="id" title="var">WHILE</span> <span class="id" title="var">b</span> <span class="id" title="var">DO</span> <span class="id" title="var">c</span> <span class="id" title="var">END</span>) <span class="id" title="var">vlist</span><br/>
| <span class="id" title="var">Vskip</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">vlist</span>, <span class="id" title="var">varlist_contains_all</span> <span class="id" title="var">SKIP</span> <span class="id" title="var">vlist</span><br/>
| <span class="id" title="var">Vass</span> : <span class="id" title="keyword">forall</span>  <span class="id" title="var">vlist</span> <span class="id" title="var">x</span> <span class="id" title="var">a</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">exists</span> <span class="id" title="var">n</span>, <span class="id" title="var">find</span> (<span class="id" title="var">Id</span> <span class="id" title="var">x</span>) <span class="id" title="var">vlist</span> = <span class="id" title="var">Some</span> <span class="id" title="var">n</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">varlist_contains_all</span> (<span class="id" title="var">x</span> ::= <span class="id" title="var">a</span>) <span class="id" title="var">vlist</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">extend_gen_vlist</span>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">varlist_contains_all</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">varlist_contains_all</span> <span class="id" title="var">a</span> (<span class="id" title="var">x</span>::<span class="id" title="var">l</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Vass</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="keyword">if</span> <span class="id" title="var">string_dec</span> <span class="id" title="var">x0</span> <span class="id" title="var">x</span> <span class="id" title="keyword">then</span> <span class="id" title="var">true</span> <span class="id" title="keyword">else</span> <span class="id" title="var">false</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">exists</span> 0. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">exists</span> (<span class="id" title="var">S</span> <span class="id" title="var">x1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Vseq</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Vifb</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Vwhile</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">gen_gen_vlist</span>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">b</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span> ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">varlist_contains_all</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">varlist_contains_all</span> <span class="id" title="var">a</span> (<span class="id" title="var">gen_vlist</span> <span class="id" title="var">b</span> <span class="id" title="var">l</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="var">find</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">E</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">extend_gen_vlist</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">cut</span> (<span class="id" title="var">varlist_contains_all</span> <span class="id" title="var">a</span> (<span class="id" title="var">gen_vlist</span> <span class="id" title="var">b1</span> <span class="id" title="var">l</span>)); <span class="id" title="tactic">intuition</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">cut</span> (<span class="id" title="var">varlist_contains_all</span> <span class="id" title="var">a</span> (<span class="id" title="var">gen_vlist</span> <span class="id" title="var">b2</span> <span class="id" title="var">l</span>)); <span class="id" title="tactic">intuition</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">gen_vlist_contains_all</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">c</span> <span class="id" title="var">l</span>, <span class="id" title="var">varlist_contains_all</span> <span class="id" title="var">c</span> (<span class="id" title="var">gen_vlist</span> <span class="id" title="var">c</span> <span class="id" title="var">l</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">c</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Vass</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">find</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">E</span>. <span class="id" title="tactic">exists</span> <span class="id" title="var">n</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">string_dec_refl</span>. <span class="id" title="tactic">exists</span> 0. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Vseq</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">gen_gen_vlist</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Vifb</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">gen_gen_vlist</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Vwhile</span>. <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">agree</span> (<span class="id" title="var">v</span> : <span class="id" title="var">varlist</span>) (<span class="id" title="var">stk</span> : <span class="id" title="var">stack</span>) (<span class="id" title="var">st</span> : <span class="id" title="var">state</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">length</span> <span class="id" title="var">stk</span> = <span class="id" title="var">length</span> <span class="id" title="var">v</span> /\<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">i</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">n</span>, <span class="id" title="var">find</span> <span class="id" title="var">i</span> <span class="id" title="var">v</span> = <span class="id" title="var">Some</span> <span class="id" title="var">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">get_nth_slot</span> <span class="id" title="var">stk</span> (<span class="id" title="var">length</span> <span class="id" title="var">stk</span> - <span class="id" title="var">length</span> <span class="id" title="var">v</span> + <span class="id" title="var">n</span>) = <span class="id" title="var">Some</span> (<span class="id" title="var">st</span> <span class="id" title="var">i</span>)) )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;/\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">find</span> <span class="id" title="var">i</span> <span class="id" title="var">v</span> = <span class="id" title="var">None</span> -&gt; <span class="id" title="var">st</span> <span class="id" title="var">i</span> = <span class="id" title="var">O</span>))<br/>
.<br/>

<br/>
<span class="id" title="keyword">Theorem</span> <span class="id" title="var">aeval_stk_appended</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">v</span> : <span class="id" title="var">varlist</span>) (<span class="id" title="var">a</span>:<span class="id" title="var">aexp</span>) (<span class="id" title="var">stk</span>: <span class="id" title="var">stack</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">nat</span>) ,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">length</span> <span class="id" title="var">v</span> &lt;= <span class="id" title="var">length</span> <span class="id" title="var">stk</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> <span class="id" title="var">stk</span> <span class="id" title="var">a</span> = <span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">s</span>::<span class="id" title="var">stk</span>) <span class="id" title="var">a</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">G</span>: <span class="id" title="keyword">forall</span> (<span class="id" title="var">n</span> <span class="id" title="var">s</span>:<span class="id" title="var">nat</span>) <span class="id" title="var">stk</span> (<span class="id" title="var">v</span>:<span class="id" title="var">varlist</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">length</span> <span class="id" title="var">stk</span> &gt;= <span class="id" title="var">length</span> <span class="id" title="var">v</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">get_nth_slot</span> (<span class="id" title="var">s</span> :: <span class="id" title="var">stk</span>) (<span class="id" title="var">length</span> (<span class="id" title="var">s</span> :: <span class="id" title="var">stk</span>) - <span class="id" title="var">length</span> <span class="id" title="var">v</span> + <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">get_nth_slot</span> <span class="id" title="var">stk</span> (<span class="id" title="var">length</span> <span class="id" title="var">stk</span> - <span class="id" title="var">length</span> <span class="id" title="var">v</span> + <span class="id" title="var">n</span>)).<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">t</span>: <span class="id" title="var">length</span> (<span class="id" title="var">s</span>::<span class="id" title="var">stk</span>) - <span class="id" title="var">length</span> <span class="id" title="var">v</span> = <span class="id" title="var">S</span> (<span class="id" title="var">length</span> <span class="id" title="var">stk</span> - <span class="id" title="var">length</span> <span class="id" title="var">v</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="var">length</span> <span class="id" title="var">v</span>). <span class="id" title="tactic">omega</span>. <span class="id" title="tactic">omega</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">aeval_stk</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">find</span> <span class="id" title="var">i</span> <span class="id" title="var">v</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">E</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">G</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">IHa1</span> <span class="id" title="var">stk</span> <span class="id" title="var">s</span> <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">cut</span> (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">s</span> :: <span class="id" title="var">stk</span>) <span class="id" title="var">a1</span> :: <span class="id" title="var">stk</span>) <span class="id" title="var">a2</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">s</span> :: <span class="id" title="var">stk</span>) <span class="id" title="var">a1</span> :: <span class="id" title="var">s</span> ::  <span class="id" title="var">stk</span>) <span class="id" title="var">a2</span>). <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">P1</span>: <span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">s</span> :: <span class="id" title="var">stk</span>) <span class="id" title="var">a2</span> = <span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> <span class="id" title="var">stk</span> <span class="id" title="var">a2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">symmetry</span>. <span class="id" title="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">P2</span>: <span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">s</span> :: <span class="id" title="var">stk</span>) <span class="id" title="var">a2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">s</span> :: <span class="id" title="var">stk</span>) <span class="id" title="var">a1</span> :: <span class="id" title="var">s</span> :: <span class="id" title="var">stk</span>) <span class="id" title="var">a2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">IHa2</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">omega</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">P3</span>: <span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">stk</span>) <span class="id" title="var">a2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">s</span> :: <span class="id" title="var">stk</span>) <span class="id" title="var">a1</span> :: <span class="id" title="var">stk</span>) <span class="id" title="var">a2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">IHa2</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">omega</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">IHa1</span> <span class="id" title="var">stk</span> <span class="id" title="var">s</span> <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">cut</span> (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">s</span> :: <span class="id" title="var">stk</span>) <span class="id" title="var">a1</span> :: <span class="id" title="var">stk</span>) <span class="id" title="var">a2</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">s</span> :: <span class="id" title="var">stk</span>) <span class="id" title="var">a1</span> :: <span class="id" title="var">s</span> ::  <span class="id" title="var">stk</span>) <span class="id" title="var">a2</span>). <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">P1</span>: <span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">s</span> :: <span class="id" title="var">stk</span>) <span class="id" title="var">a2</span> = <span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> <span class="id" title="var">stk</span> <span class="id" title="var">a2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">symmetry</span>. <span class="id" title="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">P2</span>: <span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">s</span> :: <span class="id" title="var">stk</span>) <span class="id" title="var">a2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">s</span> :: <span class="id" title="var">stk</span>) <span class="id" title="var">a1</span> :: <span class="id" title="var">s</span> :: <span class="id" title="var">stk</span>) <span class="id" title="var">a2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">IHa2</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">omega</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">P3</span>: <span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">stk</span>) <span class="id" title="var">a2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">s</span> :: <span class="id" title="var">stk</span>) <span class="id" title="var">a1</span> :: <span class="id" title="var">stk</span>) <span class="id" title="var">a2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">IHa2</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">omega</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">IHa1</span> <span class="id" title="var">stk</span> <span class="id" title="var">s</span> <span class="id" title="var">H</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">cut</span> (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">s</span> :: <span class="id" title="var">stk</span>) <span class="id" title="var">a1</span> :: <span class="id" title="var">stk</span>) <span class="id" title="var">a2</span> =<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">s</span> :: <span class="id" title="var">stk</span>) <span class="id" title="var">a1</span> :: <span class="id" title="var">s</span> ::  <span class="id" title="var">stk</span>) <span class="id" title="var">a2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">P1</span>: <span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">s</span> :: <span class="id" title="var">stk</span>) <span class="id" title="var">a2</span> = <span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> <span class="id" title="var">stk</span> <span class="id" title="var">a2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">symmetry</span>. <span class="id" title="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">P2</span>: <span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">s</span> :: <span class="id" title="var">stk</span>) <span class="id" title="var">a2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">s</span> :: <span class="id" title="var">stk</span>) <span class="id" title="var">a1</span> :: <span class="id" title="var">s</span> :: <span class="id" title="var">stk</span>) <span class="id" title="var">a2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">IHa2</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">omega</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">P3</span>: <span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">stk</span>) <span class="id" title="var">a2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> (<span class="id" title="var">s</span> :: <span class="id" title="var">stk</span>) <span class="id" title="var">a1</span> :: <span class="id" title="var">stk</span>) <span class="id" title="var">a2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">IHa2</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">omega</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">omega</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Fact</span> <span class="id" title="var">agree_aeval</span> (<span class="id" title="var">v</span> : <span class="id" title="var">varlist</span>) (<span class="id" title="var">stk</span> : <span class="id" title="var">stack</span>) (<span class="id" title="var">st</span>: <span class="id" title="var">state</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">a</span>:<span class="id" title="var">aexp</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">agree</span> <span class="id" title="var">v</span> <span class="id" title="var">stk</span> <span class="id" title="var">st</span> -&gt; <span class="id" title="var">aeval</span> <span class="id" title="var">st</span> <span class="id" title="var">a</span> = <span class="id" title="var">aeval_stk</span> <span class="id" title="var">v</span> <span class="id" title="var">stk</span> <span class="id" title="var">a</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">agree</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">a</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">reflexivity</span>.<br/>

<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="var">H0</span> <span class="id" title="var">i</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">find</span> <span class="id" title="var">i</span> <span class="id" title="var">v</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>.<br/>

<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHa1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHa2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">aeval_stk_appended</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>. <span class="id" title="tactic">omega</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>.<br/>

<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHa1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHa2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">aeval_stk_appended</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>. <span class="id" title="tactic">omega</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>.<br/>

<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHa1</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">IHa2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">aeval_stk_appended</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>. <span class="id" title="tactic">omega</span>. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">auto</span>.<br/>

<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Fact</span> <span class="id" title="var">agree_beval</span> (<span class="id" title="var">v</span> : <span class="id" title="var">varlist</span>) (<span class="id" title="var">stk</span> : <span class="id" title="var">stack</span>) (<span class="id" title="var">st</span>: <span class="id" title="var">state</span>) :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">b</span>:<span class="id" title="var">bexp</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">agree</span> <span class="id" title="var">v</span> <span class="id" title="var">stk</span> <span class="id" title="var">st</span> -&gt; <span class="id" title="var">beval</span> <span class="id" title="var">st</span> <span class="id" title="var">b</span> = <span class="id" title="var">beval_stk</span> <span class="id" title="var">v</span> <span class="id" title="var">stk</span> <span class="id" title="var">b</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">b</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">using</span> <span class="id" title="var">agree_aeval</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">IHb</span> <span class="id" title="var">H</span>). <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">IHb1</span> <span class="id" title="var">H</span>). <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">IHb2</span> <span class="id" title="var">H</span>). <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Reserved Notation</span> &quot;c1 '/' st '\\' st'"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 40, <span class="id" title="var">st</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 39).<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">ceval</span> : <span class="id" title="var">com</span> -&gt; <span class="id" title="var">state</span> -&gt; <span class="id" title="var">state</span> -&gt; <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <span class="id" title="var">E_Skip</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">st</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">SKIP</span> / <span class="id" title="var">st</span> \\ <span class="id" title="var">st</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">E_Ass</span>  : <span class="id" title="keyword">forall</span> <span class="id" title="var">st</span> <span class="id" title="var">a1</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">aeval</span> <span class="id" title="var">st</span> <span class="id" title="var">a1</span> = <span class="id" title="var">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">x</span> ::= <span class="id" title="var">a1</span>) / <span class="id" title="var">st</span> \\ (<span class="id" title="var">t_update</span> <span class="id" title="var">st</span> (<span class="id" title="var">Id</span> <span class="id" title="var">x</span>) <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">E_Seq</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span> <span class="id" title="var">st</span> <span class="id" title="var">st'</span> <span class="id" title="var">st''</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">c1</span> / <span class="id" title="var">st</span>  \\ <span class="id" title="var">st'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">c2</span> / <span class="id" title="var">st'</span> \\ <span class="id" title="var">st''</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">c1</span> ;; <span class="id" title="var">c2</span>) / <span class="id" title="var">st</span> \\ <span class="id" title="var">st''</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">E_IfTrue</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">st</span> <span class="id" title="var">st'</span> <span class="id" title="var">b</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">beval</span> <span class="id" title="var">st</span> <span class="id" title="var">b</span> = <span class="id" title="var">true</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">c1</span> / <span class="id" title="var">st</span> \\ <span class="id" title="var">st'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">IFB</span> <span class="id" title="var">b</span> <span class="id" title="var">THEN</span> <span class="id" title="var">c1</span> <span class="id" title="var">ELSE</span> <span class="id" title="var">c2</span> <span class="id" title="var">FI</span>) / <span class="id" title="var">st</span> \\ <span class="id" title="var">st'</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">E_IfFalse</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">st</span> <span class="id" title="var">st'</span> <span class="id" title="var">b</span> <span class="id" title="var">c1</span> <span class="id" title="var">c2</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">beval</span> <span class="id" title="var">st</span> <span class="id" title="var">b</span> = <span class="id" title="var">false</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">c2</span> / <span class="id" title="var">st</span> \\ <span class="id" title="var">st'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">IFB</span> <span class="id" title="var">b</span> <span class="id" title="var">THEN</span> <span class="id" title="var">c1</span> <span class="id" title="var">ELSE</span> <span class="id" title="var">c2</span> <span class="id" title="var">FI</span>) / <span class="id" title="var">st</span> \\ <span class="id" title="var">st'</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">E_WhileFalse</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">b</span> <span class="id" title="var">st</span> <span class="id" title="var">c</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">beval</span> <span class="id" title="var">st</span> <span class="id" title="var">b</span> = <span class="id" title="var">false</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">WHILE</span> <span class="id" title="var">b</span> <span class="id" title="var">DO</span> <span class="id" title="var">c</span> <span class="id" title="var">END</span>) / <span class="id" title="var">st</span> \\ <span class="id" title="var">st</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">E_WhileTrue</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">st</span> <span class="id" title="var">st'</span> <span class="id" title="var">st''</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">beval</span> <span class="id" title="var">st</span> <span class="id" title="var">b</span> = <span class="id" title="var">true</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">c</span> / <span class="id" title="var">st</span> \\ <span class="id" title="var">st'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">WHILE</span> <span class="id" title="var">b</span> <span class="id" title="var">DO</span> <span class="id" title="var">c</span> <span class="id" title="var">END</span>) / <span class="id" title="var">st'</span> \\ <span class="id" title="var">st''</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">WHILE</span> <span class="id" title="var">b</span> <span class="id" title="var">DO</span> <span class="id" title="var">c</span> <span class="id" title="var">END</span>) / <span class="id" title="var">st</span> \\ <span class="id" title="var">st''</span><br/>
<br/>
&nbsp;&nbsp;<span class="id" title="keyword">where</span> &quot;c1 '/' st '\\' st'" := (<span class="id" title="var">ceval</span> <span class="id" title="var">c1</span> <span class="id" title="var">st</span> <span class="id" title="var">st'</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">compile_aexp_correct</span>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">a</span>:<span class="id" title="var">aexp</span>) (<span class="id" title="var">C</span>:<span class="id" title="var">code</span>) (<span class="id" title="var">stk</span>:<span class="id" title="var">stack</span>) (<span class="id" title="var">pc</span>:<span class="id" title="var">nat</span>) (<span class="id" title="var">vlist</span>:<span class="id" title="var">varlist</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">ineq</span> : <span class="id" title="var">length</span> <span class="id" title="var">stk</span> &gt;= <span class="id" title="var">length</span> <span class="id" title="var">vlist</span>), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">codeseq_at</span> <span class="id" title="var">C</span> <span class="id" title="var">pc</span> (<span class="id" title="var">compile_aexp</span> (<span class="id" title="var">length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">a</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">star</span> (<span class="id" title="var">transition</span> <span class="id" title="var">C</span>) (<span class="id" title="var">pc</span>, <span class="id" title="var">stk</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">pc</span> + <span class="id" title="var">length</span>(<span class="id" title="var">compile_aexp</span> (<span class="id" title="var">length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">a</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">aeval_stk</span> <span class="id" title="var">vlist</span> <span class="id" title="var">stk</span> <span class="id" title="var">a</span>)::<span class="id" title="var">stk</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">star_one</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">trans_const</span>. <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">star_one</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">find</span> <span class="id" title="var">i</span> <span class="id" title="var">vlist</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">trans_get</span>. <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">find_get_ofs</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>  <span class="id" title="var">stk</span> <span class="id" title="var">ineq</span> <span class="id" title="var">E</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">m</span> <span class="id" title="var">mH</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">mH</span>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">trans_const</span>. <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>.<br/>

<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">star_trans</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">IHa1</span> <span class="id" title="var">C</span> <span class="id" title="var">stk</span> <span class="id" title="var">pc</span> <span class="id" title="var">vlist</span> <span class="id" title="var">ineq</span>). <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">star_trans</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">IHa2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">vlist</span>). <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">omega</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_comm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">star_one</span>. <span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">rewrite</span> <span class="id" title="var">app_length</span> || <span class="id" title="tactic">simpl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_assoc</span>. <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">Nat.add_1_r</span> (<span class="id" title="var">length</span> <span class="id" title="var">stk</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_assoc</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">p</span> := 1).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">trans_add</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Nat.add_1_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">star_trans</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">IHa1</span> <span class="id" title="var">C</span> <span class="id" title="var">stk</span> <span class="id" title="var">pc</span> <span class="id" title="var">vlist</span> <span class="id" title="var">ineq</span>). <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">star_trans</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">IHa2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">vlist</span>). <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">omega</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_comm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">star_one</span>. <span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">rewrite</span> <span class="id" title="var">app_length</span> || <span class="id" title="tactic">simpl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_assoc</span>. <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">Nat.add_1_r</span> (<span class="id" title="var">length</span> <span class="id" title="var">stk</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_assoc</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">p</span> := 1).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">trans_sub</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Nat.add_1_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">star_trans</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<span class="id" title="var">IHa1</span> <span class="id" title="var">C</span> <span class="id" title="var">stk</span> <span class="id" title="var">pc</span> <span class="id" title="var">vlist</span> <span class="id" title="var">ineq</span>). <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">star_trans</span>. <span class="id" title="tactic">apply</span> (<span class="id" title="var">IHa2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">vlist</span>). <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">omega</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_comm</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">star_one</span>. <span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">rewrite</span> <span class="id" title="var">app_length</span> || <span class="id" title="tactic">simpl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_assoc</span>. <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">Nat.add_1_r</span> (<span class="id" title="var">length</span> <span class="id" title="var">stk</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">plus_assoc</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">p</span> := 1).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">trans_mul</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Nat.add_1_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>.<br/>

<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">compile_bexp_correct</span>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">b</span>:<span class="id" title="var">bexp</span>) (<span class="id" title="var">C</span>:<span class="id" title="var">code</span>) (<span class="id" title="var">stk</span>:<span class="id" title="var">stack</span>) (<span class="id" title="var">pc</span>:<span class="id" title="var">nat</span>) (<span class="id" title="var">vlist</span>:<span class="id" title="var">varlist</span>) (<span class="id" title="var">cond</span>:<span class="id" title="var">bool</span>) (<span class="id" title="var">ofs</span>:<span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">length</span> <span class="id" title="var">stk</span> &gt;= <span class="id" title="var">length</span> <span class="id" title="var">vlist</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">codeseq_at</span> <span class="id" title="var">C</span> <span class="id" title="var">pc</span> (<span class="id" title="var">compile_bexp</span> (<span class="id" title="var">length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">b</span> <span class="id" title="var">cond</span> <span class="id" title="var">ofs</span>) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">star</span> (<span class="id" title="var">transition</span> <span class="id" title="var">C</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">pc</span>, <span class="id" title="var">stk</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">pc</span> + <span class="id" title="var">length</span> (<span class="id" title="var">compile_bexp</span> (<span class="id" title="var">length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">b</span> <span class="id" title="var">cond</span> <span class="id" title="var">ofs</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">eqb</span> (<span class="id" title="var">beval_stk</span> <span class="id" title="var">vlist</span> <span class="id" title="var">stk</span> <span class="id" title="var">b</span>) <span class="id" title="var">cond</span> <span class="id" title="keyword">then</span> <span class="id" title="var">ofs</span> <span class="id" title="keyword">else</span> 0, <span class="id" title="var">stk</span>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">b</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">cond</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">star_one</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">trans_branch_forward</span>. <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="var">normalize</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">star_refl</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">cond</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">normalize</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">star_refl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">star_one</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">trans_branch_forward</span>. <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">cond</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">star_trans</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">compile_aexp_correct</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">star_trans</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">compile_aexp_correct</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">cut</span>( <span class="id" title="var">S</span> (<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">stk</span>) &gt;= <span class="id" title="var">Datatypes.length</span> <span class="id" title="var">vlist</span>). <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Nat.add_1_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>. <span class="id" title="var">normalize</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">star_one</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">trans_beq</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Nat.add_1_r</span> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">av</span> := <span class="id" title="var">aeval_stk_appended</span> <span class="id" title="var">vlist</span> <span class="id" title="var">a0</span> <span class="id" title="var">stk</span> (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">vlist</span> <span class="id" title="var">stk</span> <span class="id" title="var">a</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">av</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">vlist</span> <span class="id" title="var">stk</span> <span class="id" title="var">a</span> =? <span class="id" title="var">aeval_stk</span> <span class="id" title="var">vlist</span> <span class="id" title="var">stk</span> <span class="id" title="var">a0</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">E</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>; <span class="id" title="var">normalize2</span>; <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">star_trans</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">compile_aexp_correct</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">star_trans</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">compile_aexp_correct</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">cut</span>( <span class="id" title="var">S</span> (<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">stk</span>) &gt;= <span class="id" title="var">Datatypes.length</span> <span class="id" title="var">vlist</span>). <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Nat.add_1_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>. <span class="id" title="var">normalize</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">star_one</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">trans_bne</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Nat.add_1_r</span> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">av</span> := <span class="id" title="var">aeval_stk_appended</span> <span class="id" title="var">vlist</span> <span class="id" title="var">a0</span> <span class="id" title="var">stk</span> (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">vlist</span> <span class="id" title="var">stk</span> <span class="id" title="var">a</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">av</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">vlist</span> <span class="id" title="var">stk</span> <span class="id" title="var">a</span> =? <span class="id" title="var">aeval_stk</span> <span class="id" title="var">vlist</span> <span class="id" title="var">stk</span> <span class="id" title="var">a0</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">E</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>; <span class="id" title="var">normalize2</span>; <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">cond</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">star_trans</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">compile_aexp_correct</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">star_trans</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">compile_aexp_correct</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">cut</span>( <span class="id" title="var">S</span> (<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">stk</span>) &gt;= <span class="id" title="var">Datatypes.length</span> <span class="id" title="var">vlist</span>). <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Nat.add_1_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>. <span class="id" title="var">normalize</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">star_one</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">trans_ble</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Nat.add_1_r</span> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">av</span> := <span class="id" title="var">aeval_stk_appended</span> <span class="id" title="var">vlist</span> <span class="id" title="var">a0</span> <span class="id" title="var">stk</span> (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">vlist</span> <span class="id" title="var">stk</span> <span class="id" title="var">a</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">av</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">vlist</span> <span class="id" title="var">stk</span> <span class="id" title="var">a</span> &lt;=? <span class="id" title="var">aeval_stk</span> <span class="id" title="var">vlist</span> <span class="id" title="var">stk</span> <span class="id" title="var">a0</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">E</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>; <span class="id" title="var">normalize2</span>; <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">star_trans</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">compile_aexp_correct</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">star_trans</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">compile_aexp_correct</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">cut</span>( <span class="id" title="var">S</span> (<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">stk</span>) &gt;= <span class="id" title="var">Datatypes.length</span> <span class="id" title="var">vlist</span>). <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Nat.add_1_r</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>. <span class="id" title="var">normalize</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">star_one</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">trans_bgt</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Nat.add_1_r</span> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">av</span> := <span class="id" title="var">aeval_stk_appended</span> <span class="id" title="var">vlist</span> <span class="id" title="var">a0</span> <span class="id" title="var">stk</span> (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">vlist</span> <span class="id" title="var">stk</span> <span class="id" title="var">a</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">av</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">aeval_stk</span> <span class="id" title="var">vlist</span> <span class="id" title="var">stk</span> <span class="id" title="var">a</span> &lt;=? <span class="id" title="var">aeval_stk</span> <span class="id" title="var">vlist</span> <span class="id" title="var">stk</span> <span class="id" title="var">a0</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">E</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>; <span class="id" title="var">normalize2</span>; <span class="id" title="tactic">reflexivity</span>. <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">eapply</span> <span class="id" title="var">star_trans</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHb</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">cond</span>; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">destruct</span> (<span class="id" title="var">beval_stk</span> <span class="id" title="var">vlist</span> <span class="id" title="var">stk</span> <span class="id" title="var">b</span>); <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">star_refl</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">cond</span>; <span class="id" title="var">normalize2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">eapply</span> <span class="id" title="var">star_trans</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHb1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">beval_stk</span> <span class="id" title="var">vlist</span> <span class="id" title="var">stk</span> <span class="id" title="var">b1</span>); <span class="id" title="var">normalize2</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">star_refl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHb2</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">eapply</span> <span class="id" title="var">star_trans</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">IHb1</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">beval_stk</span> <span class="id" title="var">vlist</span> <span class="id" title="var">stk</span> <span class="id" title="var">b1</span>);<span class="id" title="tactic">repeat</span> <span class="id" title="var">normalize2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">apply</span> <span class="id" title="var">IHb2</span>. <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">set</span> (<span class="id" title="var">pc1</span> := (<span class="id" title="var">pc</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Datatypes.length</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">compile_bexp</span> (<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">b1</span> <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ofs</span> + <span class="id" title="var">Datatypes.length</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">compile_bexp</span> (<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">stk</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">vlist</span> <span class="id" title="var">b2</span> <span class="id" title="var">false</span> <span class="id" title="var">ofs</span>))) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ofs</span> + <span class="id" title="var">Datatypes.length</span> (<span class="id" title="var">compile_bexp</span> (<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">b2</span> <span class="id" title="var">false</span> <span class="id" title="var">ofs</span>)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">pc2</span> := (<span class="id" title="var">pc</span> +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Datatypes.length</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">compile_bexp</span> (<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">b1</span> <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">ofs</span> + <span class="id" title="var">Datatypes.length</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">compile_bexp</span> (<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">stk</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">vlist</span> <span class="id" title="var">b2</span> <span class="id" title="var">false</span> <span class="id" title="var">ofs</span>))) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Datatypes.length</span> (<span class="id" title="var">compile_bexp</span> (<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">stk</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">vlist</span> <span class="id" title="var">b2</span> <span class="id" title="var">false</span> <span class="id" title="var">ofs</span>) + <span class="id" title="var">ofs</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H'</span> : <span class="id" title="var">pc1</span> = <span class="id" title="var">pc2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">unfold</span> <span class="id" title="var">pc1</span>, <span class="id" title="var">pc2</span>. <span class="id" title="tactic">omega</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">star_refl</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">mach_terminates</span> (<span class="id" title="var">C</span>: <span class="id" title="var">code</span>) (<span class="id" title="var">stk_init</span> <span class="id" title="var">stk_fin</span>: <span class="id" title="var">stack</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">pc</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">code_at</span> <span class="id" title="var">C</span> <span class="id" title="var">pc</span> = <span class="id" title="var">Some</span> <span class="id" title="var">Ihalt</span> /\<br/>
&nbsp;&nbsp;<span class="id" title="var">star</span> (<span class="id" title="var">transition</span> <span class="id" title="var">C</span>) (0, <span class="id" title="var">stk_init</span>) (<span class="id" title="var">pc</span>, <span class="id" title="var">stk_fin</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">compile_com_correct_terminating</span>:<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">c</span> : <span class="id" title="var">com</span>) (<span class="id" title="var">st</span> <span class="id" title="var">st'</span>: <span class="id" title="var">state</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">c</span> / <span class="id" title="var">st</span> \\ <span class="id" title="var">st'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">C</span>:<span class="id" title="var">code</span>) (<span class="id" title="var">stk</span>:<span class="id" title="var">stack</span>) (<span class="id" title="var">vlist</span>:<span class="id" title="var">varlist</span>) (<span class="id" title="var">pc</span>:<span class="id" title="var">nat</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">varlist_contains_all</span> <span class="id" title="var">c</span> <span class="id" title="var">vlist</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">codeseq_at</span> <span class="id" title="var">C</span> <span class="id" title="var">pc</span> (<span class="id" title="var">compile_com</span> (<span class="id" title="var">length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">c</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">agree</span> <span class="id" title="var">vlist</span> <span class="id" title="var">stk</span> <span class="id" title="var">st</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">stk'</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">star</span> (<span class="id" title="var">transition</span> <span class="id" title="var">C</span>) (<span class="id" title="var">pc</span>, <span class="id" title="var">stk</span>) (<span class="id" title="var">pc</span> + <span class="id" title="var">length</span> (<span class="id" title="var">compile_com</span> (<span class="id" title="var">length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">c</span>), <span class="id" title="var">stk'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\ <span class="id" title="var">agree</span> <span class="id" title="var">vlist</span> <span class="id" title="var">stk'</span> <span class="id" title="var">st'</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">induction</span> 1.<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">stk</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Nat.add_0_r</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">star_refl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">rename</span> <span class="id" title="var">H6</span> <span class="id" title="var">into</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H0</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">m</span> <span class="id" title="var">H0</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> ( <span class="id" title="var">n</span> := <span class="id" title="var">aeval</span> <span class="id" title="var">st</span> <span class="id" title="var">a1</span>). <span class="id" title="tactic">assert</span> (<span class="id" title="var">H</span> : <span class="id" title="var">n</span> = <span class="id" title="var">aeval</span> <span class="id" title="var">st</span> <span class="id" title="var">a1</span>). <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> <span class="id" title="var">H2</span> <span class="id" title="keyword">as</span> <span class="id" title="var">ag</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H2</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">H2</span> <span class="id" title="var">H2'</span>].<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Nstk</span> : <span class="id" title="tactic">exists</span> <span class="id" title="var">stk'</span>, <span class="id" title="var">set_nth_slot</span> <span class="id" title="var">stk</span> <span class="id" title="var">m</span> <span class="id" title="var">n</span> = <span class="id" title="var">Some</span> <span class="id" title="var">stk'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="var">set_nth_success</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">find_success_list_length</span>. <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Nstk</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">stk'</span> <span class="id" title="var">Nstk</span>].<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="var">normalize</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H0</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">star_trans</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">compile_aexp_correct</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Search</span> "ge".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">lenIneq</span> : <span class="id" title="var">length</span> <span class="id" title="var">stk</span> &gt;= <span class="id" title="var">length</span> <span class="id" title="var">vlist</span>). <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">lenIneq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">star_one</span>. <span class="id" title="var">normalize</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">trans_set</span>. <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Nat.sub_diag</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Search</span> "aeval".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">agree_aeval</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">a1</span> <span class="id" title="var">ag</span>). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Nstk</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Search</span> "set_".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">f</span>: <span class="id" title="var">length</span> <span class="id" title="var">stk'</span> = <span class="id" title="var">length</span> <span class="id" title="var">vlist</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">set_nth_length</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">stk'</span> := <span class="id" title="var">stk'</span>). <span class="id" title="tactic">apply</span> <span class="id" title="var">Nstk</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">agree</span>. <span class="id" title="tactic">split</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">t_update</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">H2'</span> <span class="id" title="var">i</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">h2</span> <span class="id" title="var">h2'</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">beq_id</span> <span class="id" title="var">x</span> <span class="id" title="var">i</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">E</span>. <span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">beq_id_true_iff</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">E</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H0</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">inversion</span> <span class="id" title="var">H3</span>. <span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">H5</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Search</span> "get_set".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">get_set_eq</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Nat.sub_diag</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Nstk</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="var">f</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">h2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Search</span> "get_other".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">h2</span> <span class="id" title="var">n0</span> <span class="id" title="var">H3</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">get_other_set</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">Nstk</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Nat.sub_diag</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">beq_id_false_iff</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Search</span> "find".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">find_inj2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H0</span> <span class="id" title="var">H3</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">contra</span> <span class="id" title="var">contra'</span>]. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">intros</span>. <span class="id" title="tactic">destruct</span> (<span class="id" title="var">H2'</span> <span class="id" title="var">i</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">h2</span> <span class="id" title="var">h2'</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="var">t_update</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">beq_id</span> <span class="id" title="var">x</span> <span class="id" title="var">i</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">E</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">beq_id_true_iff</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span> || <span class="id" title="tactic">apply</span> <span class="id" title="var">beq_id_false_iff</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H3</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H0</span>. <span class="id" title="tactic">discriminate</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">auto</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">rename</span> <span class="id" title="var">H6</span> <span class="id" title="var">into</span> <span class="id" title="var">h1</span>. <span class="id" title="tactic">rename</span> <span class="id" title="var">H8</span> <span class="id" title="var">into</span> <span class="id" title="var">h2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">C1</span>: <span class="id" title="var">codeseq_at</span> <span class="id" title="var">C</span> <span class="id" title="var">pc</span> (<span class="id" title="var">compile_com</span> (<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">c1</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">C2</span>: <span class="id" title="var">codeseq_at</span> <span class="id" title="var">C</span> (<span class="id" title="var">pc</span>+<span class="id" title="var">length</span> (<span class="id" title="var">compile_com</span> (<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">c1</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">compile_com</span> (<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">c2</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHceval1</span> <span class="id" title="var">C</span> <span class="id" title="var">stk</span> <span class="id" title="var">vlist</span> <span class="id" title="var">pc</span> <span class="id" title="var">h1</span> <span class="id" title="var">C1</span> <span class="id" title="var">H3</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">stk'</span> [<span class="id" title="var">ih1</span> <span class="id" title="var">ih1'</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> <span class="id" title="var">ih1'</span> <span class="id" title="keyword">as</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">ih1''</span> <span class="id" title="var">h1'''</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> <span class="id" title="var">H3</span> <span class="id" title="keyword">as</span> <span class="id" title="var">t</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">H3'</span> <span class="id" title="var">H3''</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">stkE</span>: <span class="id" title="var">length</span> <span class="id" title="var">stk'</span> = <span class="id" title="var">length</span> <span class="id" title="var">stk</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">omega</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">stkE</span> <span class="id" title="tactic">in</span> <span class="id" title="var">C2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHceval2</span> <span class="id" title="var">C</span> <span class="id" title="var">stk'</span> <span class="id" title="var">vlist</span> <span class="id" title="var">_</span> <span class="id" title="var">h2</span> <span class="id" title="var">C2</span> <span class="id" title="var">ih1'</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">stk''</span> [<span class="id" title="var">ih2</span> <span class="id" title="var">ih2'</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <span class="id" title="var">star_trans</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ih1</span>. <span class="id" title="var">normalize</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">stkE</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ih2</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ih2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Ct</span> : <span class="id" title="var">codeseq_at</span> <span class="id" title="var">C</span> <span class="id" title="var">pc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">compile_bexp</span> (<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">b</span> <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Datatypes.length</span> (<span class="id" title="var">compile_com</span> (<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">c1</span>) + 1))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">code_test</span> := (<span class="id" title="var">compile_bexp</span> (<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">b</span> <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Datatypes.length</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">compile_com</span> (<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">c1</span>) + 1)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">code_ifso</span> := <span class="id" title="var">compile_com</span> (<span class="id" title="var">length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">c1</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">code_ifnot</span> := <span class="id" title="var">compile_com</span> (<span class="id" title="var">length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">c2</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">C1</span> : <span class="id" title="var">codeseq_at</span> <span class="id" title="var">C</span> (<span class="id" title="var">pc</span> + <span class="id" title="var">Datatypes.length</span> <span class="id" title="var">code_test</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">compile_com</span> (<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">c1</span>)). {<span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">C2</span>: <span class="id" title="var">codeseq_at</span> <span class="id" title="var">C</span> (<span class="id" title="var">pc</span> + <span class="id" title="var">length</span> <span class="id" title="var">code_test</span> + <span class="id" title="var">length</span> <span class="id" title="var">code_ifso</span> + 1) <span class="id" title="var">code_ifnot</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> <span class="id" title="var">H3</span> <span class="id" title="keyword">as</span> <span class="id" title="var">t</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">H3'</span> <span class="id" title="var">H3''</span>]. <span class="id" title="tactic">clear</span> <span class="id" title="var">Heqt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hineq</span> : <span class="id" title="var">length</span> <span class="id" title="var">stk</span> &gt;= <span class="id" title="var">length</span> <span class="id" title="var">vlist</span>). <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">btest</span> := <span class="id" title="var">compile_bexp_correct</span> <span class="id" title="var">b</span> <span class="id" title="var">C</span> <span class="id" title="var">stk</span> <span class="id" title="var">pc</span> <span class="id" title="var">vlist</span> <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">length</span> (<span class="id" title="var">code_ifso</span>) + 1) <span class="id" title="var">Hineq</span> <span class="id" title="var">Ct</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">rename</span> <span class="id" title="var">H8</span> <span class="id" title="var">into</span> <span class="id" title="var">H1'</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">rename</span> <span class="id" title="var">H9</span> <span class="id" title="var">into</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHceval</span> <span class="id" title="var">C</span> <span class="id" title="var">stk</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H1'</span> <span class="id" title="var">C1</span> <span class="id" title="var">H3</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">stk'</span> [<span class="id" title="var">ih</span> <span class="id" title="var">ih'</span>]].<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Check</span> <span class="id" title="var">agree_beval</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <span class="id" title="var">star_trans</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">btest</span>. <span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">agree_beval</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">b</span> <span class="id" title="var">H3</span>). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fold</span> <span class="id" title="var">code_ifso</span> <span class="id" title="var">code_ifnot</span> <span class="id" title="var">code_test</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ih</span> |- *. <span class="id" title="var">normalize</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">star_trans</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ih</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">star_one</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">code_ifso</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">code_ifnot</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">trans_branch_forward</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>. <span class="id" title="tactic">unfold</span> <span class="id" title="var">code_ifso</span>, <span class="id" title="var">code_test</span>, <span class="id" title="var">code_ifnot</span>. <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H2</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Ct</span> : <span class="id" title="var">codeseq_at</span> <span class="id" title="var">C</span> <span class="id" title="var">pc</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">compile_bexp</span> (<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">b</span> <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Datatypes.length</span> (<span class="id" title="var">compile_com</span> (<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">c1</span>) + 1))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">code_test</span> := (<span class="id" title="var">compile_bexp</span> (<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">b</span> <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Datatypes.length</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">compile_com</span> (<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">c1</span>) + 1)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">code_ifso</span> := <span class="id" title="var">compile_com</span> (<span class="id" title="var">length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">c1</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">code_test</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">code_ifnot</span> := <span class="id" title="var">compile_com</span> (<span class="id" title="var">length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">c2</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">code_test</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">C1</span> : <span class="id" title="var">codeseq_at</span> <span class="id" title="var">C</span> (<span class="id" title="var">pc</span> + <span class="id" title="var">Datatypes.length</span> <span class="id" title="var">code_test</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">compile_com</span> (<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">c1</span>)). {<span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">C2</span>: <span class="id" title="var">codeseq_at</span> <span class="id" title="var">C</span> (<span class="id" title="var">pc</span> + <span class="id" title="var">length</span> <span class="id" title="var">code_test</span> + <span class="id" title="var">length</span> <span class="id" title="var">code_ifso</span> + 1) <span class="id" title="var">code_ifnot</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> <span class="id" title="var">H3</span> <span class="id" title="keyword">as</span> <span class="id" title="var">t</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">H3'</span> <span class="id" title="var">H3''</span>]. <span class="id" title="tactic">clear</span> <span class="id" title="var">Heqt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hineq</span> : <span class="id" title="var">length</span> <span class="id" title="var">stk</span> &gt;= <span class="id" title="var">length</span> <span class="id" title="var">vlist</span>). <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">btest</span> := <span class="id" title="var">compile_bexp_correct</span> <span class="id" title="var">b</span> <span class="id" title="var">C</span> <span class="id" title="var">stk</span> <span class="id" title="var">pc</span> <span class="id" title="var">vlist</span> <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">length</span> (<span class="id" title="var">code_ifso</span>) + 1) <span class="id" title="var">Hineq</span> <span class="id" title="var">Ct</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">rename</span> <span class="id" title="var">H8</span> <span class="id" title="var">into</span> <span class="id" title="var">H1'</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">H1</span>. <span class="id" title="tactic">rename</span> <span class="id" title="var">H9</span> <span class="id" title="var">into</span> <span class="id" title="var">H1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHceval</span> <span class="id" title="var">C</span> <span class="id" title="var">stk</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">H1</span> <span class="id" title="var">C2</span> <span class="id" title="var">H3</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">stk'</span> [<span class="id" title="var">ih</span> <span class="id" title="var">ih'</span>]].<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Check</span> <span class="id" title="var">agree_beval</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">eapply</span> <span class="id" title="var">star_trans</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">btest</span>. <span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">agree_beval</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">b</span> <span class="id" title="var">H3</span>). <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fold</span> <span class="id" title="var">code_ifso</span> <span class="id" title="var">code_ifnot</span> <span class="id" title="var">code_test</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ih</span> |- *. <span class="id" title="var">normalize</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <span class="id" title="var">Nat.add_1_l</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">length</span> <span class="id" title="var">code_ifnot</span>). <span class="id" title="var">normalize</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ih</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">code_body</span> := <span class="id" title="var">compile_com</span> (<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">c</span>) <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">code_test</span> := <span class="id" title="var">compile_bexp</span> (<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">b</span> <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">code_body</span> + 1)) <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Cb</span> : <span class="id" title="var">codeseq_at</span> <span class="id" title="var">C</span> (<span class="id" title="var">pc</span> + <span class="id" title="var">length</span> <span class="id" title="var">code_test</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">compile_com</span> (<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">c</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Ct</span> : <span class="id" title="var">codeseq_at</span> <span class="id" title="var">C</span> <span class="id" title="var">pc</span> (<span class="id" title="var">compile_bexp</span> (<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">b</span> <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">code_body</span> + 1))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> <span class="id" title="var">H2</span> <span class="id" title="keyword">as</span> <span class="id" title="var">t</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">H2'</span> <span class="id" title="var">H2''</span>]. <span class="id" title="tactic">clear</span> <span class="id" title="var">Heqt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hineq</span> : <span class="id" title="var">length</span> <span class="id" title="var">stk</span> &gt;= <span class="id" title="var">length</span> <span class="id" title="var">vlist</span>). <span class="id" title="tactic">omega</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">jump</span>:= <span class="id" title="var">compile_bexp_correct</span>  <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hineq</span> <span class="id" title="var">Ct</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">agree_beval</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">b</span> <span class="id" title="var">H2</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">jump</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>. 2 : <span class="id" title="tactic">apply</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">normalize</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span> <span class="id" title="tactic">in</span> <span class="id" title="var">jump</span>. <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">jump</span>. <span class="id" title="var">normalize</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fold</span> <span class="id" title="var">code_test</span> <span class="id" title="tactic">in</span> <span class="id" title="var">jump</span>. <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">code_body</span> := <span class="id" title="var">compile_com</span> (<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">c</span>) <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">code_test</span> := <span class="id" title="var">compile_bexp</span> (<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">b</span> <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">code_body</span> + 1)) <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Cb</span> : <span class="id" title="var">codeseq_at</span> <span class="id" title="var">C</span> (<span class="id" title="var">pc</span> + <span class="id" title="var">length</span> <span class="id" title="var">code_test</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">compile_com</span> (<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">c</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Ct</span> : <span class="id" title="var">codeseq_at</span> <span class="id" title="var">C</span> <span class="id" title="var">pc</span> (<span class="id" title="var">compile_bexp</span> (<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">stk</span>) <span class="id" title="var">vlist</span> <span class="id" title="var">b</span> <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">Datatypes.length</span> <span class="id" title="var">code_body</span> + 1))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">remember</span> <span class="id" title="var">H4</span> <span class="id" title="keyword">as</span> <span class="id" title="var">t</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">t</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">H4'</span> <span class="id" title="var">H4''</span>]. <span class="id" title="tactic">clear</span> <span class="id" title="var">Heqt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hineq</span> : <span class="id" title="var">length</span> <span class="id" title="var">stk</span> &gt;= <span class="id" title="var">length</span> <span class="id" title="var">vlist</span>). <span class="id" title="tactic">omega</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">jump</span>:= <span class="id" title="var">compile_bexp_correct</span>  <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hineq</span> <span class="id" title="var">Ct</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- (<span class="id" title="var">agree_beval</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">b</span> <span class="id" title="var">H4</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">jump</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">fold</span> <span class="id" title="var">code_body</span> <span class="id" title="var">code_test</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H2</span>. <span class="id" title="tactic">subst</span>. <span class="id" title="tactic">rename</span> <span class="id" title="var">H2</span> <span class="id" title="var">into</span> <span class="id" title="var">H2o</span>. <span class="id" title="tactic">rename</span> <span class="id" title="var">H8</span> <span class="id" title="var">into</span> <span class="id" title="var">H2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">IHceval1</span> <span class="id" title="var">C</span> <span class="id" title="var">stk</span> <span class="id" title="var">vlist</span> <span class="id" title="var">_</span> <span class="id" title="var">H2</span> <span class="id" title="var">Cb</span> <span class="id" title="var">H4</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">stk'</span> [<span class="id" title="var">ihb</span> <span class="id" title="var">ihb'</span>]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">V</span>: <span class="id" title="var">varlist_contains_all</span> (<span class="id" title="var">WHILE</span> <span class="id" title="var">b</span> <span class="id" title="var">DO</span> <span class="id" title="var">c</span> <span class="id" title="var">END</span>) <span class="id" title="var">vlist</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<span class="id" title="tactic">auto</span>. }<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">L</span> : <span class="id" title="var">length</span> <span class="id" title="var">stk'</span> = <span class="id" title="var">length</span> <span class="id" title="var">stk</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">destruct</span> <span class="id" title="var">H4</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">ihb'</span>. <span class="id" title="tactic">omega</span>. }          <br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">pose</span> (<span class="id" title="var">Ihc2</span> := <span class="id" title="var">IHceval2</span> <span class="id" title="var">C</span> <span class="id" title="var">stk'</span> <span class="id" title="var">_</span> <span class="id" title="var">pc</span> <span class="id" title="var">V</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">L</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ihc2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">Ihc2</span> <span class="id" title="var">H3</span> <span class="id" title="var">ihb'</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">stk''</span> <span class="id" title="var">ihc</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">star_trans</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">jump</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">fold</span> <span class="id" title="var">code_body</span> <span class="id" title="var">code_test</span>. <span class="id" title="var">normalize</span>. <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">star_trans</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">ihb</span>. <span class="id" title="tactic">fold</span> <span class="id" title="var">code_body</span> <span class="id" title="var">code_test</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">star_trans</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">star_one</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="var">trans_branch_backward</span>. <span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">codeseq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2 : {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fold</span> <span class="id" title="var">code_body</span> <span class="id" title="var">code_test</span> <span class="id" title="tactic">in</span> <span class="id" title="var">ihc</span>. <span class="id" title="var">normalize</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ihc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fold</span> <span class="id" title="var">code_body</span> <span class="id" title="var">code_test</span>. <span class="id" title="var">normalize</span>. <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">ihc</span>.<br/>
&nbsp;&nbsp;}<br/>
<span class="id" title="keyword">Qed</span>.<br/>

<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>